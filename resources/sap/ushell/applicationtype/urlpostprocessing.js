// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Supportability","sap/ui/thirdparty/hasher","sap/ushell/Config","sap/ushell/Container","sap/ushell/library","sap/ushell/User","sap/ushell/utils","sap/ushell/utils/UriParameters","sap/ushell/utils/UrlParsing"],(e,t,s,a,i,n,r,l,o)=>{"use strict";const c=i.appIntegration.contracts.StatefulType;const p={};p.processUrl=async function(e,t,s,a){const i=r.isApplicationTypeEmbeddedInIframe(t,true);const n=a&&r.isApplicationTypeEmbeddedInIframe(a.getFrameworkId());if(!i&&!n){return e}let l;let o;if(a){l=a.getTargetNavigationMode();o=a.getStatefulType()!==c.NotSupported}e=await this._processUrl(e,t,l,o,s);return e};p._processUrl=async function(e,t,a,i,n){const l={};l["sap-ie"]="edge";const o=this._getTheme(e);if(o){l["sap-theme"]=o}if(this._getAccessibility()){l["sap-accessibility"]="X"}if(this._getStatistics(e)){l["sap-statistics"]="true"}const c=this._getDensity();if(c&&c.length>0){l["sap-touch"]=c}if(!n){if(a){l["sap-target-navmode"]=a}if(t==="TR"||t==="GUI"){l["sap-keepclientsession"]="2"}else if(i){l["sap-keepclientsession"]="1"}const n=this._getInAppState();if(n&&n.length>0){l["sap-iapp-state"]=n}let o=0;if(s.last("/core/shell/sessionTimeoutIntervalInMinutes")>0){o=s.last("/core/shell/sessionTimeoutIntervalInMinutes")}l["sap-ushell-timeout"]=o;e=this._addSearchOrShellParamsToURL(e,l);return r.appendSapShellParam(e,t)}return this._addSearchOrShellParamsToURL(e,l)};p._addSearchOrShellParamsToURL=function(e,t){if(e.indexOf("#")===-1){return o.addParamsToUrl(e,t)}return o.addShellParamsToURL(e,t)};p._getAccessibility=function(){const e=r.getParameterValueBoolean("sap-accessibility");if(e!==undefined){return e}return a.getUser().getAccessibilityMode()};p._getTheme=function(e){const t=l.fromURL(e)||{mParams:{}};if(t.mParams["sap-theme"]===undefined){return a.getUser().getTheme(n.prototype.constants.themeFormat.NWBC)}return};p._getStatistics=function(t){let s=false;const a=l.fromURL(t)||{mParams:{}};s=e.isStatisticsEnabled()&&a.mParams["sap-statistics"]===undefined;return s};p._getInAppState=function(){const e=t.getHash();let s="";let a;if(e&&e.length>0&&e.indexOf("sap-iapp-state=")>0){a=/(?:sap-iapp-state=)([^&/]+)/.exec(e);if(a&&a.length===2){s=a[1]}}return s};p._getDensity=function(){let e="";const t=!!document.body?.classList.contains("sapUiSizeCompact");const s=!!document.body?.classList.contains("sapUiSizeCozy");if(t===true){e="0"}else if(s){e="1"}return e};return p});
//# sourceMappingURL=UrlPostProcessing.js.map