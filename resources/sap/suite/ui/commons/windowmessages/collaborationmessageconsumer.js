/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/base/Log"],function(n){"use strict";const e=n.getLogger("sap.suite.ui.commons.windowmessages.CollaborationMessageConsumer");let t;let o;const s="sap-suite-ui-commons-collaboration-client-appruntime";const i="collaboration-channel";const c="get-provider-config";const r="update-top-level-url";const a=[{channelId:i,version:"1.0"}];const u=["sap-suite-ui-commons-collaboration-message-broker"];const l=function(n,t,o,s,i,c){e.info(`Message Received from CLIENT_ID: ${n} on CHANNEL_ID: ${t}`);if(o===i){c(s)}else{e.info(`Message: '${o}' is not supported`)}};const f=function(n,e,s,i){l(n,e,s,i,c,function(n){t=JSON.parse(n);o(t)})};const p=function(n,t,o,s){l(n,t,o,s,r,function(n){const{success:t}=JSON.parse(n);if(t){e.info("Parent page URL successfully updated.")}})};const d=function(n){t={};n(t)};const g=async function(n,t,o){const i=sap.ui.require("sap/ushell/Container");let c;try{c=await i.getServiceAsync("MessageBroker");try{await c.connect(n,Function.prototype);e.info(`Client ID: ${n} is connected successfully`)}catch{e.warn("Could not connect to the Message Broker");return null}await c.subscribe(n,t,o);return c}catch(n){e.error(`Error during connect or subscribe: ${n}`);c?.disconnect(s);return null}};return{getProviderConfiguration:function(){return new Promise(async function(n){if(t){n(t);return}o=n;const r=sap.ui.require("sap/ushell/Container");if(!r){e.info("UShell Container instance doesn't exist");d(n);return}let l;try{l=await g(s,a,f);if(l){await l.publish(i,s,c,u);try{l.disconnect(s)}catch(e){n(t)}}else{d(n)}}catch(t){e.info("Provider Configuration doesn't exist");l?.disconnect(s);d(n)}})},updateTopLevelURLforAppRuntime:async function(n){let t;try{t=await g(s,a,p);if(t){const o=JSON.stringify({url:n});await t.publish(i,s,r,u,o);try{t.disconnect(s);e.info(`Client ID: ${s} disconnected successfully`)}catch(n){e.info("Disconnect failed")}}}catch(n){t?.disconnect(s)}}}});
//# sourceMappingURL=CollaborationMessageConsumer.js.map